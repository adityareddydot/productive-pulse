<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#6366f1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Productivity Pulse</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div id="app">
    <!-- Onboarding Screen -->
    <div id="onboarding" class="screen">
      <div class="onboarding-content">
        <div class="logo-pulse">
          <span class="pulse-ring"></span>
          <span class="pulse-icon">‚ö°</span>
        </div>
        <h1>Productivity Pulse</h1>
        <p class="subtitle">Track your focus. Build better habits.</p>

        <div class="setup-card">
          <h3>How often should I check in?</h3>
          <div class="interval-buttons">
            <button class="interval-btn" data-interval="0.0166">1m</button>
            <button class="interval-btn" data-interval="0.25">15m</button>
            <button class="interval-btn" data-interval="0.5">30m</button>
            <button class="interval-btn" data-interval="1">1h</button>
            <button class="interval-btn active" data-interval="2">2h</button>
            <button class="interval-btn" data-interval="3">3h</button>
          </div>
          <div class="custom-interval-row">
            <label>Custom (minutes):</label>
            <input type="number" id="custom-interval" min="1" max="1440" placeholder="e.g. 45">
            <button id="apply-custom-interval" class="small-btn">Apply</button>
          </div>
        </div>

        <div class="setup-card">
          <h3>Quiet hours (no notifications)</h3>
          <div class="time-inputs">
            <div class="time-group">
              <label>From</label>
              <input type="time" id="quiet-start" value="23:00">
            </div>
            <div class="time-group">
              <label>To</label>
              <input type="time" id="quiet-end" value="07:00">
            </div>
          </div>
        </div>

        <button id="start-btn" class="primary-btn">
          <span>Start Tracking</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard" class="screen hidden">
      <header class="dashboard-header">
        <div class="date-nav">
          <button id="prev-date" class="icon-btn small">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6" />
            </svg>
          </button>
          <button id="date-picker-btn" class="date-display">
            <span id="current-date">Today</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
          </button>
          <button id="next-date" class="icon-btn small">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6" />
            </svg>
          </button>
        </div>
        <button id="settings-btn" class="icon-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3" />
            <path
              d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" />
          </svg>
        </button>
      </header>

      <!-- Hidden date input -->
      <input type="date" id="date-input" class="hidden-date-input">

      <div class="stats-row">
        <div class="stat-card productive">
          <span class="stat-value" id="productive-hours">0h</span>
          <span class="stat-label">Productive</span>
        </div>
        <div class="stat-card wasted">
          <span class="stat-value" id="wasted-hours">0h</span>
          <span class="stat-label">Low Focus</span>
        </div>
      </div>

      <div class="timeline-section">
        <div class="timeline-header">
          <h2>Timeline</h2>
          <span class="timeline-hint">Tap to edit</span>
        </div>
        <div id="timeline" class="timeline"></div>
      </div>

      <div class="chart-section">
        <h2>Categories</h2>
        <div class="chart-container">
          <canvas id="category-chart"></canvas>
          <div id="chart-legend" class="chart-legend"></div>
        </div>
      </div>

      <button id="log-now-btn" class="fab">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <line x1="12" y1="5" x2="12" y2="19" />
          <line x1="5" y1="12" x2="19" y2="12" />
        </svg>
      </button>
    </div>

    <!-- Quick Log Screen -->
    <div id="quick-log" class="screen hidden">
      <button id="close-log" class="close-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>

      <div class="log-content">
        <h2 id="log-title">How was the last hour?</h2>

        <!-- Slot Selector -->
        <div class="slot-selector">
          <button id="prev-slot" class="slot-nav-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6" />
            </svg>
          </button>
          <span class="log-time" id="log-time-label">10:00 AM - 11:00 AM</span>
          <button id="next-slot" class="slot-nav-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6" />
            </svg>
          </button>
        </div>

        <div class="productivity-grid">
          <button class="prod-btn red" data-level="1">
            <span class="prod-emoji">üò´</span>
            <span class="prod-label">Not Productive</span>
          </button>
          <button class="prod-btn orange" data-level="2">
            <span class="prod-emoji">üòï</span>
            <span class="prod-label">Low Focus</span>
          </button>
          <button class="prod-btn yellow" data-level="3">
            <span class="prod-emoji">üôÇ</span>
            <span class="prod-label">Moderate</span>
          </button>
          <button class="prod-btn green" data-level="4">
            <span class="prod-emoji">üöÄ</span>
            <span class="prod-label">Crushing It!</span>
          </button>
        </div>

        <div class="category-section">
          <h3>What were you doing?</h3>
          <div id="category-pills" class="category-pills">
            <!-- Populated by JS -->
          </div>
        </div>

        <div class="note-section" id="note-section">
          <textarea id="log-note" placeholder="Add a note (optional)..." rows="2"></textarea>
        </div>

        <button id="save-log-btn" class="primary-btn" style="margin-top: 16px;">
          <span>Save Entry</span>
        </button>
      </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings" class="screen hidden">
      <header class="settings-header">
        <button id="back-btn" class="icon-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7" />
          </svg>
        </button>
        <h1>Settings</h1>
      </header>

      <div class="settings-content">
        <div class="setting-group">
          <h3>Check-in Interval</h3>
          <div class="interval-buttons">
            <button class="interval-btn" data-interval="0.0166">1m</button>
            <button class="interval-btn" data-interval="0.25">15m</button>
            <button class="interval-btn" data-interval="0.5">30m</button>
            <button class="interval-btn" data-interval="1">1h</button>
            <button class="interval-btn" data-interval="2">2h</button>
            <button class="interval-btn" data-interval="3">3h</button>
          </div>
          <div class="custom-interval-row">
            <label>Custom (minutes):</label>
            <input type="number" id="settings-custom-interval" min="1" max="1440" placeholder="e.g. 45">
            <button id="settings-apply-interval" class="small-btn">Apply</button>
          </div>
        </div>

        <div class="setting-group">
          <h3>Quiet Hours</h3>
          <div class="time-inputs">
            <div class="time-group">
              <label>From</label>
              <input type="time" id="settings-quiet-start" value="23:00">
            </div>
            <div class="time-group">
              <label>To</label>
              <input type="time" id="settings-quiet-end" value="07:00">
            </div>
          </div>
        </div>

        <div class="setting-group">
          <h3>Categories</h3>
          <div id="manage-categories" class="category-list">
            <!-- Populated by JS -->
          </div>
          <button id="add-category-btn" class="secondary-btn">+ Add Category</button>
        </div>

        <div class="setting-group">
          <h3>Data</h3>
          <button id="export-btn" class="secondary-btn">Export Data</button>
          <button id="clear-btn" class="danger-btn">Clear All Data</button>
        </div>

        <div class="setting-group">
          <label class="toggle-setting">
            <span>Tracking Enabled</span>
            <input type="checkbox" id="tracking-toggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Add Category Modal -->
    <div id="category-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h3>Add New Category</h3>
        <div class="modal-form">
          <div class="form-group">
            <label>Emoji</label>
            <input type="text" id="new-category-emoji" placeholder="üìö" maxlength="2">
          </div>
          <div class="form-group">
            <label>Name</label>
            <input type="text" id="new-category-name" placeholder="e.g. Reading">
          </div>
        </div>
        <div class="modal-actions">
          <button id="cancel-category" class="secondary-btn">Cancel</button>
          <button id="save-category" class="primary-btn">Add</button>
        </div>
      </div>
    </div>

    <!-- Edit Slot Modal -->
    <div id="edit-slot-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h3>Edit Time Slot</h3>
        <p id="edit-slot-time" class="modal-subtitle">10:00 AM - 11:00 AM</p>

        <div class="mini-productivity-grid">
          <button class="mini-prod-btn red" data-level="1">üò´</button>
          <button class="mini-prod-btn orange" data-level="2">üòï</button>
          <button class="mini-prod-btn yellow" data-level="3">üôÇ</button>
          <button class="mini-prod-btn green" data-level="4">üöÄ</button>
          <button class="mini-prod-btn gray" data-level="0">‚ùì</button>
        </div>

        <div class="modal-category-pills" id="edit-category-pills">
          <!-- Populated by JS -->
        </div>

        <div class="modal-actions">
          <button id="delete-slot" class="danger-btn">Delete</button>
          <button id="cancel-edit-slot" class="secondary-btn">Cancel</button>
          <button id="save-edit-slot" class="primary-btn">Save</button>
        </div>
      </div>
    </div>
    <!-- In-App Notification Toast -->
    <div id="notification-toast" class="notification-toast hidden">
      <div class="toast-content">
        <div class="toast-icon">‚ö°</div>
        <div class="toast-text">
          <strong>Time to log!</strong>
          <span id="toast-message">How was the last hour?</span>
        </div>
        <button id="toast-log-btn" class="toast-action">Log Now</button>
        <button id="toast-dismiss" class="toast-close">√ó</button>
      </div>
    </div>
  </div>

  <script src="js/storage.js"></script>
  <script src="js/notifications.js"></script>
  <script src="js/scheduler.js"></script>
  <script src="js/analytics.js"></script>
  <script src="js/app.js"></script>
</body>

</html>